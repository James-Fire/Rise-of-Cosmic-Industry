namespace = spaceexploit

planet_event = {
	id = spaceexploit.10000
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		solar_system = {
			random_system_planet = {
				limit = {
					has_planet_flag = exploit_center
				}
				if = {
					limit = {
						has_global_flag = exploitation_logging
					}
					log = "Adding Minor Colony on [ROOT.GetName] for [This.GetName]"
					log = "Minor Colony Count [This.small_colony_count] on [This.GetName]"
					log = "Exploit Constructions [This.exploitation_trade] on [This.GetName]"
				}
			}
		}
		set_variable = { which = exploitation_size value = 0 }
		colonize_exploit_planet = yes
		if = {
			limit = {
				has_global_flag = exploitation_logging
			}
			log = "Size starting [This.exploitation_size] on [This.GetName]"
		}
		solar_system = {
			random_system_planet = {
				limit = {
					has_planet_flag = exploit_center
				}
				if = {
					limit = {
						has_global_flag = exploitation_logging
					}
					log = "Minor Colony Count [This.small_colony_count] on [This.GetName]"
					log = "Exploit Constructions [This.exploitation_trade] on [This.GetName]"
				}
			}
		}
	}
}
#Mineral Mine
planet_event = {
	id = spaceexploit.1
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_mine_loop = yes
	}
}
planet_event = {
	id = spaceexploit.102
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_mine = yes
	}
}

#Power Plant
planet_event = {
	id = spaceexploit.2
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_power_loop = yes
	}
}
planet_event = {
	id = spaceexploit.202
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_power = yes
	}
}


#Alloy Casting
planet_event = {
	id = spaceexploit.4
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_alloy_foundry_loop = yes
	}
}
planet_event = {
	id = spaceexploit.402
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_alloy_foundry = yes
	}
}

#Alloy Mining
planet_event = {
	id = spaceexploit.5
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_alloy_mine_loop = yes
	}
}
planet_event = {
	id = spaceexploit.502
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_alloy_mine = yes
	}
}

#Volatile Motes
planet_event = {
	id = spaceexploit.7
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_motes_loop = yes
	}
}
planet_event = {
	id = spaceexploit.702
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_motes = yes
	}
}
#Rare Crystals
planet_event = {
	id = spaceexploit.8
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_crystals_loop = yes
	}
}
planet_event = {
	id = spaceexploit.802
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_crystals = yes
	}
}
#Exotic Gases
planet_event = {
	id = spaceexploit.9
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_gases_loop = yes
	}
}
planet_event = {
	id = spaceexploit.902
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_gases = yes
	}
}
#Lava Refinery
planet_event = {
	id = spaceexploit.10
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_lava_refinery_loop = yes
	}
}
planet_event = {
	id = spaceexploit.1002
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_lava_refinery = yes
	}
}

#Research Labs
planet_event = {
	id = spaceexploit.12
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		exploit_research_loop = yes
	}
}
planet_event = {
	id = spaceexploit.1202
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		build_exploit_research = yes
	}
}	


planet_event = {
	id = spaceexploit.13
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		planet_event = { id = spaceexploit.30 days = @YearConstructionTime }
		planet_event = { id = spaceexploit.1301 days = @YearConstructionTime }
		ROOT = { change_variable = { which = exploitation_size value = -3 } }
	}
}

planet_event = {
	id = spaceexploit.1301
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		remove_modifier = building_thing
		add_modifier = { modifier = terraforming_candidate }
	}
}



planet_event = {
	id = spaceexploit.30
	hide_window = yes
	is_triggered_only = yes
	location = ROOT
	
	immediate = {
		solar_system = {
			if = {
				limit = {
					any_system_planet = {
						has_planet_flag = exploit_center
					}
				}
				every_system_planet = {
					limit = {
						has_planet_flag = exploit_center
						owner = {
							is_gestalt = no
						}
					}
					add_deposit = space_ex_construction_1
					change_variable = { which = exploitation_trade value = 1 }
				}
				every_system_planet = {
					limit = {
						has_planet_flag = exploit_center
						owner = {
							is_gestalt = yes
						}
					}
					add_deposit = space_ex_construction_1
					change_variable = { which = exploitation_trade value = 1 }
				}
			}
		}
	}
}

country_event = {
	id = spaceexploit.32
	#title = "spaceexploit.1.name"
	#desc = "spaceexploit.1.desc"
	#picture = GFX_evt_asteroid_approaching_planet
	is_triggered_only = yes
	#location = FROM
	#auto_opens = no
	hide_window = yes
	
	immediate = {
	}
	#option = {
	#	name = "Next project!"
	#}
}

country_event = {
	id = spaceexploit.33
	#title = "spaceexploit.2.name"
	#desc = "spaceexploit.2.desc"
	#picture = GFX_evt_asteroid_approaching_planet
	is_triggered_only = yes
	#location = FROM
	#auto_opens = no
	hide_window = yes
	
	immediate = {
	}
	#option = {
	#	name = "Next project!"
	#}
}

country_event = {
	id = spaceexploit.35
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_owned_planet = {
			limit = {
				has_planet_flag = exploit_center
			}
			if = {
				limit = {
					has_global_flag = exploitation_logging
				}
				log = "Minor Colony Count [This.small_colony_count] on [This.GetName]"
				log = "Exploit Constructions [This.exploitation_trade] on [This.GetName]"
			}
			set_variable = { which = colonytemp value = small_colony_count }
			set_variable = { which = exploittemp value = exploitation_trade }
			every_deposit = {
				if = {
					limit = {
						OR = {
							is_deposit_type = d_trade_value_1
							is_deposit_type = space_ex_construction_1
							is_deposit_type = d_small_colonies
						}
					}
					remove_deposit = yes
				}
			}
		}
	}
	after = {
		every_owned_planet = {
			limit = {
				has_planet_flag = exploit_center
			}
			if = {
				limit = {
					has_global_flag = exploitation_logging
				}
				log = "Minor Colony Count [This.colonytemp] on [This.GetName]"
				log = "Exploit Constructions [This.exploittemp] on [This.GetName]"
			}
			while = {
				count = 10000
				limit = {
					check_variable = { which = exploittemp value > 0 }
				}
				change_variable = { which = exploittemp value = -1 }
				add_deposit = space_ex_construction_1
			}
			while = {
				count = 50
				limit = {
					check_variable = { which = colonytemp value > 0 }
				}
				change_variable = { which = colonytemp value = -1 }
				add_deposit = d_small_colonies
			}
		}
	}
}

event = {
	id = spaceexploit.36
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = exploit_speed_difficulty
		every_country = {
			limit = {
				is_country_type = default
			}
			country_event = { id = spaceexploit.37 days = 2 }
		}
	}
}

country_event = {
	id = spaceexploit.37
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		log = "Exploit Colonies for [This.GetName]"
		game_start_colonies = yes
	}
	
	after = {
		every_planet_within_border = {
			limit = {
				has_modifier = colonized_planet
				has_deposit_for = shipclass_mining_station
			}
			log = "Created Mining Station on [This.GetName] for [PREV.GetName]"
			create_mining_station = {
				owner = ROOT
			}
		}
		every_planet_within_border = {
			limit = {
				has_modifier = colonized_planet
				has_deposit_for = shipclass_research_station
			}
			log = "Created Research Station on [This.GetName] for [PREV.GetName]"
			create_research_station = {
				owner = ROOT
			}
		}
	}
}

country_event = {
	id = spaceexploit.40
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					last_increased_tech = tech_starbase_3
					last_increased_tech = tech_starbase_4
					last_increased_tech = tech_starbase_5
					last_increased_tech = tech_habitat_1
					last_increased_tech = tech_habitat_2
					last_increased_tech = tech_habitat_3
				}
			}
			every_planet_within_border = {
				limit = {
					has_modifier = colonized_planet
				}
				random_list = {
					10 = {
						planet_event = { id = spaceexploit.42 days = 10 }
					}
					10 = {
						planet_event = { id = spaceexploit.42 days = 40 }
					}
					10 = {
						planet_event = { id = spaceexploit.42 days = 70 }
					}
					10 = {
						planet_event = { id = spaceexploit.42 days = 100 }
					}
				}
			}
		} 
	}
}

event = {
	id = spaceexploit.41
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			if = {
				limit = {
					NOT = {
						has_country_flag = has_arcology_project_exploit
					}
					has_ascension_perk = ap_arcology_project
				}
				set_country_flag = has_arcology_project_exploit
				every_planet_within_border = {
					limit = {
						has_modifier = colonized_planet
					}
					random_list = {
						10 = {
							planet_event = { id = spaceexploit.42 days = 10 }
						}
						10 = {
							planet_event = { id = spaceexploit.42 days = 40 }
						}
						10 = {
							planet_event = { id = spaceexploit.42 days = 70 }
						}
						10 = {
							planet_event = { id = spaceexploit.42 days = 100 }
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						has_country_flag = has_voidborn_exploit
					}
					has_ascension_perk = ap_voidborn
				}
				set_country_flag = has_voidborn_exploit
				every_planet_within_border = {
					limit = {
						has_modifier = colonized_planet
					}
					random_list = {
						10 = {
							planet_event = { id = spaceexploit.42 days = 10 }
						}
						10 = {
							planet_event = { id = spaceexploit.42 days = 40 }
						}
						10 = {
							planet_event = { id = spaceexploit.42 days = 70 }
						}
						10 = {
							planet_event = { id = spaceexploit.42 days = 100 }
						}
					}
				}
			}
		}
	}
	after = {
		
	}
}

planet_event = {
	id = spaceexploit.42
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		upgrade_exploit_size = yes
	}
	after = {
		ai_colony_switch = yes	
	}
}

planet_event = {
	id = spaceexploit.43
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				check_variable = { which = exploitation_size value = 0 }
			}
			set_variable = { which = exploitation_size value = 0 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_technology = tech_starbase_3
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_technology = tech_starbase_4
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_technology = tech_starbase_5
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_technology = tech_habitat_1
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_technology = tech_habitat_2
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_technology = tech_habitat_3
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_ascension_perk = ap_voidborn
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
		if = {
			limit = {
				solar_system = {
					space_owner = {
						has_ascension_perk = ap_arcology_project
					}
				}
			}
			change_variable = { which = exploitation_size value = 1 }
		}
	}
	after = {
		if = {
			limit = {
				NOT = {
					has_modifier = building_thing
				}
				OR = {
					solar_system = {
						space_owner = {
							is_ai = yes
							has_country_flag = exploit_automation
						}
					}
				}
			}
			ai_colony_switch = yes
		}
	}
}